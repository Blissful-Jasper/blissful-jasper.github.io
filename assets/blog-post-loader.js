class BlogPostLoader{constructor(){this.blogData=null,this.currentPost=null,this.init()}async init(){await this.loadBlogData(),this.setupEventListeners(),this.loadCurrentPost()}async loadBlogData(){try{this.blogData=[{title:"Welcome to My Academic Website!",date:"2025-06-29",summary:"欢迎来到我的学术网站！",file:"2025-06-29-welcome.md",tags:["welcome","introduction","academic"],category:"academic"},{title:"深度学习在气象预报中的应用",date:"2025-07-01",summary:"探讨深度学习技术在气象预报领域的应用与发展",file:"2025-07-01-deep-learning-weather-forecast.md",tags:["深度学习","气象预报","机器学习","科研"],category:"research"}]}catch(t){console.error("Failed to load blog data:",t)}}setupEventListeners(){var t=document.getElementById("like-btn"),e=document.getElementById("share-btn"),a=document.getElementById("bookmark-btn");t&&t.addEventListener("click",()=>this.toggleLike()),e&&e.addEventListener("click",()=>this.sharePost()),a&&a.addEventListener("click",()=>this.toggleBookmark())}async loadCurrentPost(){let e=new URLSearchParams(window.location.search).get("file");e?(this.currentPost=this.blogData.find(t=>t.file===e),this.currentPost?(this.updatePostInfo(),await this.loadPostContent(e),this.setupNavigation()):this.showError("文章信息未找到","无法找到对应的文章信息")):this.showError("文章未找到","请检查链接是否正确")}updatePostInfo(){let a={title:document.getElementById("post-title"),breadcrumb:document.getElementById("current-post-title"),date:document.getElementById("post-date"),category:document.getElementById("post-category"),tags:document.getElementById("post-tags")};a.title&&(a.title.textContent=this.currentPost.title),a.breadcrumb&&(a.breadcrumb.textContent=this.currentPost.title),a.date&&(a.date.textContent=this.formatDate(this.currentPost.date)),a.category&&(a.category.textContent=this.currentPost.category),a.tags&&this.currentPost.tags&&(a.tags.innerHTML="",this.currentPost.tags.forEach(t=>{var e=document.createElement("span");e.className="tag",e.textContent=t,a.tags.appendChild(e)}))}async loadPostContent(e){try{var a=await fetch("/_posts/"+e);if(!a.ok)throw new Error("HTTP error! status: "+a.status);let t=await a.text();t=t.replace(/^---[\s\S]*?---\n/,"");var o=this.parseMarkdown(t),r=document.getElementById("post-content");r&&(r.innerHTML=o)}catch(t){console.error("Failed to load post content:",t),this.showError("内容加载失败","无法加载文章内容，请稍后重试")}}parseMarkdown(t){return t.replace(/^### (.*$)/gm,"<h3>$1</h3>").replace(/^## (.*$)/gm,"<h2>$1</h2>").replace(/^# (.*$)/gm,"<h1>$1</h1>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/^\- (.*$)/gm,"<li>$1</li>").replace(/(<li>.*<\/li>)/s,"<ul>$1</ul>").replace(/\n\n/g,"</p><p>").replace(/^(?!<[h|u|o])/gm,"<p>").replace(/(?<![>])\n(?!<)/g,"</p><p>").replace(/<p><\/p>/g,"").replace(/<p>(<h[1-6]>)/g,"$1").replace(/(<\/h[1-6]>)<\/p>/g,"$1").replace(/<p>(<[u|o]l>)/g,"$1").replace(/(<\/[u|o]l>)<\/p>/g,"$1")}setupNavigation(){var t,e=this.blogData.findIndex(t=>t.file===this.currentPost.file);0<e&&(t=this.blogData[e-1],this.setupNavItem("prev-post",t,"上一篇")),e<this.blogData.length-1&&(t=this.blogData[e+1],this.setupNavItem("next-post",t,"下一篇"))}setupNavItem(t,e,a){var o,r,t=document.getElementById(t);t&&(o=t.querySelector(".nav-link"),r=t.querySelector(".nav-title"),o&&(o.href="blog-post-dynamic.html?file="+e.file),r&&(r.textContent=e.title),t.style.display="block")}showError(t,e){var a=document.getElementById("post-content");a&&(a.innerHTML=`
                <div class="error-message">
                    <i class="fas fa-exclamation-triangle"></i>
                    <h3>${t}</h3>
                    <p>${e}</p>
                    <a href="/blog.html" class="btn btn-primary">返回博客首页</a>
                </div>
            `)}formatDate(t){return new Date(t).toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric"})}toggleLike(){var t=document.getElementById("like-btn");t&&(t.classList.toggle("liked"),t=t.querySelector("i"))&&(t.classList.toggle("far"),t.classList.toggle("fas"))}sharePost(){var t=(this.currentPost||document).title;let e=window.location.href;navigator.share?navigator.share({title:t,url:e}).catch(t=>console.log("Error sharing:",t)):navigator.clipboard.writeText(e).then(()=>{alert("链接已复制到剪贴板！")}).catch(t=>{console.error("无法复制链接:",t),prompt("请复制以下链接:",e)})}toggleBookmark(){var t=document.getElementById("bookmark-btn");t&&(t.classList.toggle("bookmarked"),t=t.querySelector("i"))&&(t.classList.toggle("far"),t.classList.toggle("fas"))}}document.addEventListener("DOMContentLoaded",()=>{new BlogPostLoader});