let fs=require("fs"),path=require("path"),blogDir=path.join(__dirname,"blog"),files=fs.readdirSync(blogDir).filter(e=>e.endsWith(".md")),posts=files.map(e=>{var i=fs.readFileSync(path.join(blogDir,e),"utf-8"),t=i.match(/^#\s*(.+)/m),t=t?t[1].trim():e,r=i.match(/date\s*[:=]\s*([\d-]+)/i);let s="",l=(r?s=r[1]:/\d{4}-\d{2}-\d{2}/.test(e)&&(s=e.match(/\d{4}-\d{2}-\d{2}/)[0]),"");for(var a,r=i.match(/\n([^#\n][^\n]{10,})/),n=(r&&(l=r[1].replace(/!\[.*?\]\(.*?\)/g,"").trim().slice(0,60)),[]),d=/!\[.*?\]\((.*?)\)/g;null!==(a=d.exec(i));)n.push(a[1]);return{title:t,date:s,summary:l,file:"blog/"+e,images:n}});fs.writeFileSync(path.join(blogDir,"index.json"),JSON.stringify(posts,null,2));