#!/bin/bash
# Git Pre-commit Hook - è‡ªåŠ¨é¡¹ç›®æ¸…ç†
# æ­¤æ–‡ä»¶åº”è¯¥å¤åˆ¶åˆ° .git/hooks/pre-commit å¹¶è®¾ç½®æ‰§è¡Œæƒé™

echo "ğŸ§¹ è¿è¡Œè‡ªåŠ¨é¡¹ç›®æ¸…ç†..."

# æ£€æŸ¥æ¸…ç†è„šæœ¬æ˜¯å¦å­˜åœ¨
if [[ -f "cleanup.sh" ]]; then
    # è¿è¡Œæ¸…ç†è„šæœ¬ (é™é»˜æ¨¡å¼)
    ./cleanup.sh > /dev/null 2>&1
    
    # æ£€æŸ¥æ˜¯å¦æœ‰æ–‡ä»¶è¢«åˆ é™¤
    if git diff --quiet && git diff --staged --quiet; then
        echo "âœ… é¡¹ç›®å·²æ˜¯å¹²å‡€çŠ¶æ€"
    else
        echo "ğŸ—‘ï¸  æ¸…ç†äº†ä¸´æ—¶æ–‡ä»¶å’Œæ—¥å¿—"
        # å°†æ¸…ç†åçš„æ›´æ”¹æ·»åŠ åˆ°staging area
        git add .
    fi
else
    echo "âš ï¸  æ¸…ç†è„šæœ¬æœªæ‰¾åˆ°ï¼Œè·³è¿‡è‡ªåŠ¨æ¸…ç†"
fi

echo "âœ… é¢„æäº¤æ£€æŸ¥å®Œæˆ"
exit 0
